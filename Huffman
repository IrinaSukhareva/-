#define _CRT_SECURE_NO_WARNINGS
#include <iostream>
#include <fstream>
#include <string>
#include <queue>
#include <unordered_map>
#include <map>
#include <stdio.h> 
using namespace std;

struct Node{
	char letter; //буква
	unsigned int count; //кол-во встречаемости
	Node *left, *right;
};

//добавление нового узла дерева
Node* addNode(char key, unsigned int count1, Node* left, Node* right){
	Node* node = new Node();
	node->letter = key;
	node->count = count1;
	node->left = left;
	node->right = right;
return node;
}

void Huffman(const char* original = "original.txt", const char* cipher = "cipher.txt") {
    FILE* input;
    input = fopen(original, "r");

    if (!input) {
        puts("ERROR: original text does not open\n");
        exit(1);
    }
    
    //подсчитывает частоту появления каждого символа и сохраните его на карте
	int number = 0;
	unsigned char c;
    map<char, int>count1;
    while (!feof(input)) {
        c= fgetc(input);
        if (c != EOF){
            count1[c]++;
            number++;
            }
        }
    fclose (input);

    FILE* output;
    input = fopen(original, "r");
    output = fopen(cipher, "w");
    if (!input || !output){
        puts("ERROR: the texts didn't open\n"); 
        exit(1);
    }
    
    fprintf(output, "%d", number);
    for (auto pair : count1) {
        fprintf(output, "%c", pair.first);
        fprintf(output, "%d", pair.second);
    }


    fclose(input);
    fclose(output);
}


int main(){
Huffman();
}
